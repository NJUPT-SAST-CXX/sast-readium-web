# AI 助手

SAST Readium 包含集成的 AI 助手，帮助您使用自然语言理解、分析和与 PDF 文档交互。

## 概述

AI 助手提供：

- **PDF 上下文感知**: 理解当前文档内容
- **自然语言查询**: 用自然语言提问
- **工具调用**: 执行搜索和导航等操作
- **多提供商支持**: 支持多种 AI 提供商
- **MCP 集成**: 通过模型上下文协议连接外部工具

## 入门

### 打开 AI 侧边栏

- 点击工具栏中的 AI 图标
- 或按 ++ctrl+shift+i++

### 初始设置

1. 打开 AI 设置（侧边栏中的齿轮图标）
2. 选择您的 AI 提供商
3. 输入您的 API 密钥
4. 选择模型
5. 开始聊天！

## 支持的提供商

### 内置提供商

| 提供商        | 模型                   | 功能             |
| ------------- | ---------------------- | ---------------- |
| **OpenAI**    | GPT-4o, GPT-4, GPT-3.5 | 文本、视觉、工具 |
| **Anthropic** | Claude 3.5, Claude 3   | 文本、视觉、工具 |

### 自定义提供商

添加任何 OpenAI 兼容的 API：

1. 打开 AI 设置
2. 点击"添加自定义提供商"
3. 输入：
   - 提供商名称
   - API 端点 URL
   - API 密钥
   - 可用模型

## PDF 上下文

### 自动上下文

AI 自动接收以下上下文：

- 当前页面内容
- 文档元数据
- 选中的文本
- 可见的注释

### 上下文选项

配置共享的上下文：

| 选项         | 描述           |
| ------------ | -------------- |
| **当前页面** | 可见页面的文本 |
| **选中内容** | 当前选中的文本 |
| **完整文档** | 整个文档文本   |
| **元数据**   | 标题、作者等   |

## 聊天功能

### 基本聊天

输入您的问题，按 ++enter++ 或点击发送。

**示例问题：**

- "总结这一页"
- "这个文档的主要观点是什么？"
- "解释第 5 页的概念"
- "找出所有提到'机器学习'的地方"

### 流式响应

响应实时流式传输：

- 看到文本生成过程
- 随时停止生成
- 更快的感知响应时间

### 消息历史

- 对话自动保存
- 从历史标签访问
- 继续之前的对话
- 导出聊天历史

## 工具调用

AI 可以在 PDF 查看器中执行操作。

### 可用工具

| 工具               | 描述               |
| ------------------ | ------------------ |
| `search_document`  | 在 PDF 中搜索文本  |
| `navigate_to_page` | 跳转到特定页面     |
| `get_page_content` | 读取页面内容       |
| `get_selection`    | 获取当前选中的文本 |
| `highlight_text`   | 添加高亮注释       |
| `add_bookmark`     | 创建书签           |

### 多步执行

AI 可以链接多个工具：

1. 搜索术语
2. 导航到结果
3. 总结内容
4. 添加书签

### 工具可见性

在聊天中查看工具调用：

```text
🔧 正在搜索"神经网络"...
📄 找到 5 个结果
📍 正在导航到第 12 页...
```

## MCP 集成

### 模型上下文协议

连接到外部 MCP 服务器获取额外功能：

- 文件系统访问
- 数据库查询
- API 集成
- 自定义工具

### 配置 MCP 服务器

1. 打开 AI 设置
2. 转到"MCP 服务器"部分
3. 点击"添加服务器"
4. 输入服务器配置：

```json
{
  "name": "my-server",
  "command": "npx",
  "args": ["-y", "@my/mcp-server"],
  "env": {}
}
```

## 高级功能

### 深度研究

多步研究工作流：

1. 点击"深度研究"按钮
2. 输入您的研究问题
3. AI 执行多次搜索
4. 综合发现
5. 生成综合报告

### 图表洞察

分析图表和图形：

1. 在 PDF 中选择图表
2. 点击"分析图表"
3. AI 提取数据和洞察
4. 提供解释

### 报告生成

生成结构化报告：

1. 点击"生成报告"
2. 选择报告模板
3. AI 分析文档
4. 生成格式化报告

## 设置

### 模型设置

| 设置         | 描述             |
| ------------ | ---------------- |
| **温度**     | 创造性级别 (0-2) |
| **最大令牌** | 响应长度限制     |
| **Top P**    | 核采样           |
| **存在惩罚** | 主题多样性       |

### 功能开关

| 功能         | 描述             |
| ------------ | ---------------- |
| **启用工具** | 允许工具调用     |
| **多步**     | 允许链式工具调用 |
| **流式**     | 启用流式响应     |
| **上下文**   | 包含 PDF 上下文  |

## 键盘快捷键

| 快捷键           | 操作           |
| ---------------- | -------------- |
| ++ctrl+shift+i++ | 切换 AI 侧边栏 |
| ++ctrl+enter++   | 发送消息       |
| ++escape++       | 取消生成       |
| ++ctrl+l++       | 清除聊天       |

## 最佳实践

### 有效提示

1. **具体明确**: "总结方法论部分" vs "总结这个"
2. **提供上下文**: "基于第 3 页的图表..."
3. **追问**: 基于之前的响应继续
4. **使用示例**: "按照...格式输出"

### 管理成本

1. 根据任务使用适当的模型
2. 尽可能限制上下文
3. 使用流式传输提前停止
4. 监控令牌使用

### 隐私考虑

1. 审查共享的上下文
2. 对敏感文档使用本地模型
3. 需要时清除历史
4. 检查提供商隐私政策

## 故障排除

### API 密钥问题

- 验证密钥正确
- 检查密钥权限
- 确保账单已激活
- 尝试重新生成密钥

### 响应缓慢

- 检查网络连接
- 尝试更快的模型
- 减少上下文大小
- 检查提供商状态

### 工具失败

- 验证工具权限
- 检查 PDF 已加载
- 尝试更简单的请求
- 查看错误消息

## API 密钥安全

### 存储

- 密钥在浏览器存储中加密
- 永不发送到我们的服务器
- 仅发送到 AI 提供商

### 最佳实践

- 开发中使用环境变量
- 定期轮换密钥
- 不同环境使用不同密钥
- 监控使用异常
